@model WebApplication8.Models.LoginViewModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign In - Doodle World</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <style>
        body {
            background-color: #000;
            color: #E1E9EE;
            font-family: system-ui, -apple-system, sans-serif;
            overflow: hidden;
            height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- BACKGROUND LAYER --- */
        #background-doodles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.5; /* Balanced so doodles are visible but don't hide the form */
            pointer-events: none;
        }

        .bg-doodle {
            position: absolute;
            width: 60px;
            height: 60px;
            /* White outlines for doodles */
            stroke: #fff;
            stroke-width: 2;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        /* Background Eyelid Logic */
        .eyelid {
            fill: #000;
            stroke: none;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: translateY(-100%); /* Lid stays up */
        }

        body.eyes-closed .eyelid {
            transform: translateY(0%); /* Lid drops down */
        }

        /* --- MAIN LAYOUT --- */
        .split-container {
            display: flex;
            align-items: center;
            gap: 80px;
            max-width: 1100px;
            width: 90%;
            z-index: 10;
        }

        .doodle-section {
            flex: 1;
            display: flex;
            justify-content: center;
            gap: 30px;
        }

        .login-section {
            flex: 1;
            display: flex;
            justify-content: center;
        }

        .login-card {
            background-color: #1D2226;
            border-radius: 12px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            border: 1px solid #38434F;
            box-shadow: 0 0 100px rgba(0,0,0,1);
            position: relative;
            z-index: 20;
        }

        /* --- BLOO CHARACTER STYLING (Main) --- */
        .doodle {
            width: 130px;
            height: 160px;
            transition: transform 0.1s ease-out;
            filter: drop-shadow(0 10px 10px rgba(0,0,0,0.5));
        }

        .body-shape {
            stroke-width: 4;
            stroke-linejoin: round;
        }

        .doodle-yellow .body-shape {
            fill: #FFFC00;
            stroke: #D4D100;
        }

        .doodle-blue .body-shape {
            fill: #0095F6;
            stroke: #0077C7;
        }

        .doodle-red .body-shape {
            fill: #FF4B4B;
            stroke: #D63E3E;
        }

        .eye-white {
            fill: #fff;
            stroke: none;
        }

        .eye-pupil {
            fill: #000;
            stroke: none;
            transition: transform 0.05s linear;
        }

        /* Idle Stretch Animation */
        @@keyframes stretch {
            0%, 100% {
                transform: scaleY(1);
            }

            50% {
                transform: scaleY(1.05) translateY(-5px);
            }
        }

        .doodle {
            animation: stretch 3s infinite ease-in-out;
        }

        .arm-group {
            transform-origin: center bottom;
            transition: transform 0.1s ease-out;
        }

        .doodle-section.covering .left-arm {
            transform: translate(20px, -60px) rotate(135deg) !important;
        }

        .doodle-section.covering .right-arm {
            transform: translate(-20px, -60px) rotate(-135deg) !important;
        }

        /* SQUINTING STATE (Proximity) */
        .doodle.squinting .eye-white {
            transform: scaleY(0.4); /* Squish the white part of eye */
        }
        /* Stop stretching when squinting or covering */
        .doodle.squinting, .doodle-section.covering .doodle {
            animation-play-state: paused;
        }

        .form-control {
            background-color: #12171B;
            border: 1px solid #38434F;
            color: white;
            border-radius: 8px;
        }

        .btn-primary {
            background-color: #0A66C2;
            border-radius: 24px;
            font-weight: bold;
            border: none;
        }
    </style>
</head>
<body>

    <div id="background-doodles"></div>

    <div class="split-container">

        <div class="doodle-section" id="doodleArea">
            <div class="doodle doodle-yellow">
                <svg viewBox="0 0 100 130">
                    <path class="body-shape" d="M10,130 L10,50 C10,10 90,10 90,50 L90,130 Z" />
                    <circle class="eye-white" cx="35" cy="50" r="12" />
                    <circle class="eye-pupil js-pupil" cx="35" cy="50" r="5" />
                    <circle class="eye-white" cx="65" cy="50" r="12" />
                    <circle class="eye-pupil js-pupil" cx="65" cy="50" r="5" />
                    <g class="arm-group left-arm js-arm" style="transform-origin: 25px 90px;"><rect x="15" y="90" width="18" height="35" rx="9" fill="#FFFC00" /></g>
                    <g class="arm-group right-arm js-arm" style="transform-origin: 75px 90px;"><rect x="67" y="90" width="18" height="35" rx="9" fill="#FFFC00" /></g>
                </svg>
            </div>
            <div class="doodle doodle-blue">
                <svg viewBox="0 0 100 130">
                    <path class="body-shape" d="M10,130 L10,50 C10,10 90,10 90,50 L90,130 Z" />
                    <circle class="eye-white" cx="35" cy="50" r="12" />
                    <circle class="eye-pupil js-pupil" cx="35" cy="50" r="5" />
                    <circle class="eye-white" cx="65" cy="50" r="12" />
                    <circle class="eye-pupil js-pupil" cx="65" cy="50" r="5" />
                    <g class="arm-group left-arm js-arm" style="transform-origin: 25px 90px;"><rect x="15" y="90" width="18" height="35" rx="9" fill="#0095F6" /></g>
                    <g class="arm-group right-arm js-arm" style="transform-origin: 75px 90px;"><rect x="67" y="90" width="18" height="35" rx="9" fill="#0095F6" /></g>
                </svg>
            </div>
            <div class="doodle doodle-red">
                <svg viewBox="0 0 100 130">
                    <path class="body-shape" d="M10,130 L10,50 C10,10 90,10 90,50 L90,130 Z" />
                    <circle class="eye-white" cx="35" cy="50" r="12" />
                    <circle class="eye-pupil js-pupil" cx="35" cy="50" r="5" />
                    <circle class="eye-white" cx="65" cy="50" r="12" />
                    <circle class="eye-pupil js-pupil" cx="65" cy="50" r="5" />
                    <g class="arm-group left-arm js-arm" style="transform-origin: 25px 90px;"><rect x="15" y="90" width="18" height="35" rx="9" fill="#FF4B4B" /></g>
                    <g class="arm-group right-arm js-arm" style="transform-origin: 75px 90px;"><rect x="67" y="90" width="18" height="35" rx="9" fill="#FF4B4B" /></g>
                </svg>
            </div>
        </div>

        <div class="login-section">
            <div class="login-card">
                <h2 class="text-center fw-bold mb-4">Sign in</h2>
                <form asp-action="Login" method="post">
                    <div class="mb-3">
                        <input asp-for="Email" class="form-control form-control-lg" placeholder="Email" />
                    </div>
                    <div class="mb-4">
                        <input asp-for="Password" id="passwordField" class="form-control form-control-lg" placeholder="Password" />
                    </div>
                    <button type="submit" class="btn btn-primary w-100 py-2">Sign in</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const passwordField = document.getElementById('passwordField');
            const doodleArea = document.getElementById('doodleArea');
            const bgContainer = document.getElementById('background-doodles');
            const doodles = document.querySelectorAll('.doodle');

            // --- 1. DOODLE GENERATION LIBRARY ---
            // Helper to create an eye at specific coordinates
            function getEyeSVG(cx, cy, uniqueId) {
                return `
                    <g>
                        <clipPath id="clip_${uniqueId}">
                            <circle cx="${cx}" cy="${cy}" r="6" />
                        </clipPath>
                        <circle cx="${cx}" cy="${cy}" r="6" fill="#fff" stroke="none"/>
                        <circle class="eye-pupil js-pupil" cx="${cx}" cy="${cy}" r="2.5" fill="#000" stroke="none" />
                        <g clip-path="url(#clip_${uniqueId})">
                            <rect class="eyelid" x="${cx-10}" y="${cy-10}" width="20" height="20" />
                        </g>
                    </g>
                `;
            }

            // Definitions of different random doodles
                   const doodleTypes = [
            // --- NATURE & WEATHER ---
            (id) => `<path d="M40,10 L50,40 L80,40 L55,60 L65,90 L40,70 L15,90 L25,60 L0,40 L30,40 Z" />${getEyeSVG(40, 45, id)}`, // Star
            (id) => `<circle cx="40" cy="40" r="25" /><path d="M40,15 L40,5 M65,40 L75,40 M40,65 L40,75 M15,40 L5,40" />${getEyeSVG(32, 40, id+'a')}${getEyeSVG(48, 40, id+'b')}`, // Sun
            (id) => `<path d="M20,60 Q40,10 60,60 Z" /><path d="M35,60 L35,75 L45,75 L45,60" />${getEyeSVG(40, 35, id)}`, // Mushroom
            (id) => `<path d="M40,70 L40,30 M40,40 C60,40 60,20 40,20 C20,20 20,40 40,40" />${getEyeSVG(40, 30, id)}`, // Flower/Tulip
            (id) => `<path d="M30,70 L30,30 Q30,10 50,10 L50,50 Q50,70 30,70" />${getEyeSVG(40, 30, id)}`, // Leaf
            (id) => `<path d="M30,70 L30,30 Q30,20 40,20 Q50,20 50,30 L50,70" /><path d="M50,40 L60,35 M30,50 L20,45" />${getEyeSVG(40, 35, id)}`, // Cactus
            (id) => `<path d="M10,60 L40,15 L70,60 Z" /><path d="M30,40 L50,40" />${getEyeSVG(40, 45, id)}`, // Mountain
            (id) => `<path d="M20,30 A20,20 0 1,0 20,50 A15,15 0 1,1 20,30" />${getEyeSVG(35, 40, id)}`, // Crescent Moon

            // --- FOOD ---
            (id) => `<path d="M15,20 L65,20 L40,70 Z" /><circle cx="30" cy="35" r="3" /><circle cx="50" cy="35" r="3" />${getEyeSVG(40, 30, id)}`, // Pizza Slice
            (id) => `<circle cx="40" cy="40" r="20" /><circle cx="40" cy="40" r="8" />${getEyeSVG(40, 28, id)}`, // Donut
            (id) => `<path d="M30,70 L50,70 L60,30 L20,30 Z" /><path d="M20,30 Q40,0 60,30" />${getEyeSVG(40, 40, id)}`, // Cupcake
            (id) => `<path d="M30,40 L40,70 L50,40 Z" /><path d="M25,40 Q40,10 55,40" />${getEyeSVG(40, 35, id)}`, // Ice Cream Cone
            (id) => `<circle cx="30" cy="30" r="10" /><circle cx="50" cy="30" r="10" /><path d="M40,40 L40,70" />${getEyeSVG(30, 30, id+'a')}${getEyeSVG(50, 30, id+'b')}`, // Cherries
            (id) => `<path d="M20,40 Q40,70 60,40 Z" />${getEyeSVG(35, 45, id+'a')}${getEyeSVG(45, 45, id+'b')}`, // Taco/Watermelon
            (id) => `<rect x="30" y="20" width="20" height="40" rx="5" /><path d="M40,60 L40,75" />${getEyeSVG(40, 35, id)}`, // Popsicle

            // --- OBJECTS ---
            (id) => `<rect x="25" y="20" width="30" height="40" /><path d="M25,30 L55,30" />${getEyeSVG(40, 45, id)}`, // Book
            (id) => `<circle cx="40" cy="35" r="15" /><path d="M35,50 L45,50 L40,65 Z" />${getEyeSVG(40, 35, id)}`, // Lightbulb
            (id) => `<path d="M20,20 L60,20 L60,50 L40,70 L20,50 Z" />${getEyeSVG(32, 35, id+'a')}${getEyeSVG(48, 35, id+'b')}`, // Envelope/House
            (id) => `<rect x="20" y="30" width="40" height="30" rx="2" /><path d="M30,30 L30,20 M50,30 L50,20" />${getEyeSVG(40, 45, id)}`, // TV
            (id) => `<circle cx="40" cy="40" r="20" /><path d="M40,20 L40,40 L55,40" />${getEyeSVG(32, 35, id)}`, // Clock
            (id) => `<path d="M40,70 Q20,70 20,45 Q20,20 40,20 Q60,20 60,45 Q60,70 40,70" />${getEyeSVG(33, 45, id+'a')}${getEyeSVG(47, 45, id+'b')}`, // Bloo-style Ghost
            (id) => `<path d="M20,35 L30,25 L50,25 L60,35 L60,55 L20,55 Z" /><circle cx="40" cy="40" r="8" />${getEyeSVG(40, 40, id)}`, // Camera

            // --- ANIMALS & CRITTERS ---
            (id) => `<circle cx="35" cy="40" r="15" /><path d="M50,40 Q70,40 70,30" />${getEyeSVG(35, 40, id)}`, // Snail
            (id) => `<path d="M20,40 Q40,10 60,40 Q40,70 20,40" /><path d="M60,40 L75,30 L75,50 Z" />${getEyeSVG(35, 40, id)}`, // Fish
            (id) => `<circle cx="40" cy="45" r="20" /><path d="M30,28 L25,15 L40,25 M50,28 L55,15 L40,25" />${getEyeSVG(32, 45, id+'a')}${getEyeSVG(48, 45, id+'b')}`, // Cat
            (id) => `<circle cx="40" cy="40" r="15" /><path d="M25,40 L15,30 M55,40 L65,30 M40,25 L40,10" />${getEyeSVG(40, 40, id)}`, // Butterfly/Bug
            (id) => `<path d="M40,20 Q60,20 60,40 Q60,60 40,60 Q20,60 20,40 Q20,20 40,20" /><circle cx="40" cy="65" r="5" />${getEyeSVG(40, 40, id)}`, // Spider
            (id) => `<path d="M20,50 Q40,20 60,50" /><path d="M25,50 L25,65 M55,50 L55,65" />${getEyeSVG(40, 45, id)}`, // Crab/Turtle Shell

            // --- SYMBOLS & ABSTRACT ---
            (id) => `<path d="M40,70 C10,40 20,10 40,30 C60,10 70,40 40,70" />${getEyeSVG(32, 40, id+'a')}${getEyeSVG(48, 40, id+'b')}`, // Heart
            (id) => `<path d="M40,10 Q70,40 40,70 Q10,40 40,10" />${getEyeSVG(40, 40, id)}`, // Diamond
            (id) => `<path d="M20,20 L30,20 L30,60 L20,60 Z M50,20 L60,20 L60,60 L50,60 Z" />${getEyeSVG(25, 40, id+'a')}${getEyeSVG(55, 40, id+'b')}`, // Pause Sign
            (id) => `<path d="M10,40 L70,40 M40,10 L40,70" />${getEyeSVG(25, 25, id+'a')}${getEyeSVG(55, 55, id+'b')}`, // Cross
            (id) => `<path d="M20,20 Q40,40 20,60 Q0,40 20,20 M60,20 Q80,40 60,60 Q40,40 60,20" />${getEyeSVG(40, 40, id)}`, // Infinity/Eyes
            (id) => `<circle cx="40" cy="40" r="25" fill="none" stroke-dasharray="5,5" />${getEyeSVG(40, 40, id)}`, // Portal

            // --- SPACE & MISC ---
            (id) => `<path d="M10,40 Q40,0 70,40 Q40,80 10,40 Z" /><path d="M30,40 L50,40" />${getEyeSVG(40, 30, id)}`, // UFO
            (id) => `<rect x="30" y="10" width="20" height="50" rx="2" /><path d="M30,50 L20,70 M50,50 L60,70" />${getEyeSVG(40, 25, id)}`, // Rocket
            (id) => `<path d="M20,20 L60,60 M60,20 L20,60" />${getEyeSVG(40, 30, id+'a')}${getEyeSVG(40, 50, id+'b')}`, // "X" Marks the spot
            (id) => `<path d="M40,10 L40,70 M10,40 L70,40" transform="rotate(45 40 40)" />${getEyeSVG(40, 40, id)}`, // Plus
            (id) => `<path d="M20,40 C20,10 60,10 60,40 C60,70 20,70 20,40" />${getEyeSVG(30, 40, id+'a')}${getEyeSVG(50, 40, id+'b')}${getEyeSVG(40, 55, id+'c')}`, // Three-eyed Blob
            (id) => `<circle cx="40" cy="40" r="10" /><path d="M10,10 L30,30 M70,70 L50,50 M70,10 L50,30 M10,70 L30,50" />${getEyeSVG(40, 40, id)}` // Sparkle
        ];

            // Generate Doodles
            const density = 80;
            for(let i=0; i<density; i++) {
                const div = document.createElement('div');
                div.className = 'bg-doodle';

                // Random Position
                let left = Math.random() * 100;
                let top = Math.random() * 100;

                // Keep center clear
                if(left > 35 && left < 65 && top > 30 && top < 70) continue;

                div.style.left = left + 'vw';
                div.style.top = top + 'vh';

                // Random Size/Rotation
                const scale = 0.5 + Math.random() * 0.8;
                const rotate = Math.random() * 40 - 20; // Slight tilt
                div.style.transform = `scale(${scale}) rotate(${rotate}deg)`;

                // Pick Random Doodle
                const typeIndex = Math.floor(Math.random() * doodleTypes.length);
                const doodleContent = doodleTypes[typeIndex](i);

                div.innerHTML = `<svg viewBox="0 0 80 80">${doodleContent}</svg>`;
                bgContainer.appendChild(div);
            }

            // --- 2. GLOBAL CURSOR TRACKING ---
            const pupils = document.querySelectorAll('.js-pupil');
            const arms = document.querySelectorAll('.js-arm');

            window.addEventListener('mousemove', (e) => {
                const mouseX = e.clientX;
                const mouseY = e.clientY;

                if (document.activeElement !== passwordField) {
                    // Move Pupils
                    pupils.forEach(pupil => {
                        const rect = pupil.getBoundingClientRect();
                        const x = rect.left + rect.width/2;
                        const y = rect.top + rect.height/2;
                        const angle = Math.atan2(mouseY - y, mouseX - x);

                        // Background eyes move less
                        const isBg = pupil.closest('.bg-doodle');
                        const dist = isBg ? 2 : 6;

                        pupil.style.transform = `translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist}px)`;
                    });

                    // Sway Arms (Main Characters)
                    arms.forEach(arm => {
                        const rect = arm.getBoundingClientRect();
                        const x = rect.left + rect.width/2;
                        const angle = (mouseX - x) / window.innerWidth * 30;
                        arm.style.transform = `rotate(${angle}deg)`;
                    });

                    // Stretch Main Characters
                    doodles.forEach(d => {
                        const rect = d.getBoundingClientRect();
                        const distY = Math.abs(mouseY - (rect.top + rect.height/2));
                        const stretch = 1 + (distY / window.innerHeight * 0.15);
                        d.style.transform = `scaleY(${stretch})`;
                    });
                }
            });

            // --- 3. PASSWORD INTERACTION ---
            passwordField.addEventListener('focus', () => {
                doodleArea.classList.add('covering');
                document.body.classList.add('eyes-closed');
                doodles.forEach(d => d.style.animation = 'none');
            });

            passwordField.addEventListener('blur', () => {
                doodleArea.classList.remove('covering');
                document.body.classList.remove('eyes-closed');
                doodles.forEach(d => d.style.animation = 'stretch 3s infinite ease-in-out');
            });
        });
    </script>
</body>
</html>